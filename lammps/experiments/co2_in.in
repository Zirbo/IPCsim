#
units real
boundary p p p
atom_style full

read_data config_co2_sys.txt

# interaction styles
pair_style lj/cut/coul/cut 12.0
bond_style harmonic
angle_style harmonic
pair_modify mix geometric tail yes

# force field parameters
# missing nonbonded parameters are inferred from mixing.
pair_coeff    1 1 0.0537 2.80    # C of CO2 ( 27 K = 0.0537 kcal/mol)
pair_coeff    2 2 0.1570 3.05    # O of CO2 (79 K = 0.1570 kcal/mol)
bond_coeff  1 999.9 1.16         # C=O (999.9 = fake number since not used)
angle_coeff 1 999.9 180.0       # O=C=O (999.9 = fake number since not used)

velocity all create 100.0 53244 dist gaussian mom no rot no

group clump id <> 1 375

#fix 1 clump rigid/small molecule # my_ketran = finite number
#fix 1 clump rigid/nve/small molecule # doesn't work with computing ke for rigid objects - Segmentation fault
#fix 1 clump rigid/nvt/small molecule temp 100.0 100.0 100.0 # doesn't work with computing ke for rigid objects - Segmentation fault
#fix 1 clump rigid molecule # my_ketran = finite number
fix 1 clump rigid/nve molecule # my_ketran = finite number
#fix 1 clump rigid/nvt molecule temp 100.0 100.0 100.0 # my_ketran = finite number

compute my_ketran clump ke/rigid 1
compute my_kerot clump erotate/rigid 1
compute my_temp clump temp

##minimize 1.0e-4 1.0e-6 100 1000

timestep 1.0
reset_timestep 0
neigh_modify every 10 delay 20 check yes
thermo 500

#thermo_style multi
thermo_style custom step c_my_ketran c_my_kerot temp c_my_temp pe ebond eangle

dump 1 all atom 100 dump.lammpstrj

run 0
